(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ae9d071","chunk-2d0a43ba"],{"0620":function(e,t,r){"use strict";r.r(t);var n=r("2a40"),o=[{key:0,value:"hash随机"},{key:2,value:"负载均衡"}],a=[{key:null,value:"全部"},{key:0,value:"停止"},{key:1,value:"已启动"}];t["default"]={strategyList:o,statusList:a,strategyMap:n["a"].listToMap(o),statusMap:n["a"].listToMap(a)}},"23ba":function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return l}));var n=r("b775");function o(e){return Object(n["a"])({url:"/tesseract-group/allGroup",method:"get",params:e})}function a(e){return Object(n["a"])({url:"/tesseract-group/groupList",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/tesseract-group/addGroup",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/tesseract-group/deleteGroup",method:"get",params:e})}},4303:function(e,t,r){"use strict";r.d(t,"e",(function(){return o})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return l})),r.d(t,"f",(function(){return s})),r.d(t,"h",(function(){return u})),r.d(t,"g",(function(){return c})),r.d(t,"d",(function(){return g}));var n=r("b775");function o(e){return Object(n["a"])({url:"/tesseract-trigger/triggerList",method:"get",params:e})}function a(e){return Object(n["a"])({url:"/tesseract-trigger/addTrigger",method:"post",data:e})}function i(e){return Object(n["a"])({url:"/tesseract-trigger/delete",method:"get",params:e})}function l(e){return Object(n["a"])({url:"/tesseract-trigger/execute",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/tesseract-trigger/start",method:"get",params:e})}function u(e){return Object(n["a"])({url:"/tesseract-trigger/stop",method:"get",params:e})}function c(e){return Object(n["a"])({url:"/tesseract-firedTrigger/stop",method:"get",params:e})}function g(e){return Object(n["a"])({url:"/tesseract-firedTrigger/firedTriggerList",method:"get",params:e})}},"740b":function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return l}));var n=r("b775");function o(e){return Object(n["a"])({url:"/tesseract-executor/executorList",method:"get",params:e})}function a(e){return Object(n["a"])({url:"/tesseract-executor/executorListNoDetail",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/tesseract-executor/addExecutor",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/tesseract-executor/deleteExecutor",method:"get",params:e})}},a888:function(e,t,r){"use strict";r("c041"),r("40c5"),r("23cc");var n={bind:function(e,t,r){var n=e.querySelector(".el-dialog__header"),o=e.querySelector(".el-dialog");n.style.cssText+=";cursor:move;",o.style.cssText+=";top:0px;";var a=function(){return window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]}}();n.onmousedown=function(e){var t=e.clientX-n.offsetLeft,i=e.clientY-n.offsetTop,l=o.offsetWidth,s=o.offsetHeight,u=document.body.clientWidth,c=document.body.clientHeight,g=o.offsetLeft,d=u-o.offsetLeft-l,f=o.offsetTop,p=c-o.offsetTop-s,m=a(o,"left"),b=a(o,"top");m.includes("%")?(m=+document.body.clientWidth*(+m.replace(/\%/g,"")/100),b=+document.body.clientHeight*(+b.replace(/\%/g,"")/100)):(m=+m.replace(/\px/g,""),b=+b.replace(/\px/g,"")),document.onmousemove=function(e){var n=e.clientX-t,a=e.clientY-i;-n>g?n=-g:n>d&&(n=d),-a>f?a=-f:a>p&&(a=p),o.style.cssText+=";left:".concat(n+m,"px;top:").concat(a+b,"px;"),r.child.$emit("dragDialog")},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}},o=function(e){e.directive("el-drag-dialog",n)};window.Vue&&(window["el-drag-dialog"]=n,Vue.use(o)),n.install=o;t["a"]=n},df2f:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-row",[r("el-form",{attrs:{inline:!0,model:e.selectInfo}},[e.$store.getters.buttons.contains("/trigger/index/select")?r("div",[r("el-form-item",{attrs:{label:"触发器名"}},[r("el-input",{attrs:{placeholder:"触发器名"},model:{value:e.selectInfo.name,callback:function(t){e.$set(e.selectInfo,"name",t)},expression:"selectInfo.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"执行器名"}},[r("el-input",{attrs:{placeholder:"执行器名"},model:{value:e.selectInfo.executorName,callback:function(t){e.$set(e.selectInfo,"executorName",t)},expression:"selectInfo.executorName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"所属组"}},[r("el-input",{attrs:{placeholder:"所属组"},model:{value:e.selectInfo.groupName,callback:function(t){e.$set(e.selectInfo,"groupName",t)},expression:"selectInfo.groupName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"任务描述"}},[r("el-input",{attrs:{placeholder:"任务描述"},model:{value:e.selectInfo.description,callback:function(t){e.$set(e.selectInfo,"description",t)},expression:"selectInfo.description"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"状态"}},[r("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.selectInfo.status,callback:function(t){e.$set(e.selectInfo,"status",t)},expression:"selectInfo.status"}},e._l(e.statusList,(function(e){return r("el-option",{attrs:{label:e.value,value:e.key}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"创建人"}},[r("el-input",{attrs:{placeholder:"创建人"},model:{value:e.selectInfo.creator,callback:function(t){e.$set(e.selectInfo,"creator",t)},expression:"selectInfo.creator"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.getTriggerList}},[e._v("查询")])],1)],1):e._e(),e._v(" "),r("el-form-item",[e.$store.getters.buttons.contains("/trigger/index/add")?r("el-button",{attrs:{type:"success"},on:{click:function(t){return e.addTriggerInfo(null)}}},[e._v("新增触发器\n        ")]):e._e()],1)],1)],1),e._v(" "),r("el-row",[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.triggerList,border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{align:"center",label:"ID",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.id))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"名字"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"执行器"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.executorName))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"下一次调度时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(0==t.row.nextTriggerTime?"":e.parseTime(t.row.nextTriggerTime)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"cron表达式",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.cron))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"调度策略"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.strategyMap.get(t.row.strategy)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"分片数"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.shardingNum))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"重试次数"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.retryCount))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status||2==t.row.status?r("span",{staticStyle:{color:"#67C23A","font-weight":"bold"}},[e._v(e._s(e.statusMap.get(t.row.status)))]):r("span",{staticStyle:{color:"#F56C6C","font-weight":"bold"}},[e._v(e._s(e.statusMap.get(t.row.status)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"创建者"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.creator))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"创建时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(0==t.row.createTime?"":e.parseTime(t.row.createTime)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"所属组"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.groupName))])]}}])}),e._v(" "),e.$store.getters.buttons.contains("/trigger/index/edit")||e.$store.getters.buttons.contains("/trigger/index/delete")?r("el-table-column",{attrs:{align:"center",label:"操作",width:"440"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$store.getters.buttons.contains("/trigger/index/edit")?r("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-edit"},on:{click:function(r){return e.addTriggerInfo(t.row)}}},[e._v("\n            修改\n          ")]):e._e(),e._v(" "),e.$store.getters.buttons.contains("/trigger/index/edit")?r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(r){return e.execute(t.row)}}},[e._v("\n            执行\n          ")]):e._e(),e._v(" "),0==t.row.status&&e.$store.getters.buttons.contains("/trigger/index/edit")?r("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-edit"},on:{click:function(r){return e.start(t.row)}}},[e._v("\n            启动\n          ")]):e._e(),e._v(" "),1==t.row.status&&e.$store.getters.buttons.contains("/trigger/index/edit")?r("el-button",{attrs:{type:"info",size:"small",icon:"el-icon-edit"},on:{click:function(r){return e.stop(t.row)}}},[e._v("\n            停止\n          ")]):e._e(),e._v(" "),e.$store.getters.buttons.contains("/trigger/index/delete")?r("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(r){return e.deleteTrigger(t.row)}}},[e._v("\n            删除\n          ")]):e._e()]}}],null,!1,3981152828)}):e._e()],1)],1),e._v(" "),r("el-row",[r("el-pagination",{attrs:{total:e.selectInfo.total,"current-page":e.selectInfo.currentPage,"page-size":e.selectInfo.pageSize,align:"center",background:"",layout:"prev, pager, next"},on:{"current-change":e.pageChange}})],1),e._v(" "),r("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{visible:e.dialogTableVisible,title:"触发器信息"},on:{"update:visible":function(t){e.dialogTableVisible=t},dragDialog:e.handleDrag}},[r("el-form",{ref:"triggerForm",attrs:{inline:!1,model:e.triggerInfo,rules:e.triggerRules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"触发器名字",prop:"name"}},[r("el-input",{ref:"name",attrs:{placeholder:"触发器名字"},model:{value:e.triggerInfo.name,callback:function(t){e.$set(e.triggerInfo,"name",t)},expression:"triggerInfo.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"cron表达式",prop:"cron"}},[r("el-input",{ref:"cron",attrs:{placeholder:"cron表达式"},model:{value:e.triggerInfo.cron,callback:function(t){e.$set(e.triggerInfo,"cron",t)},expression:"triggerInfo.cron"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"分片数",prop:"shardingNum"}},[r("el-input",{ref:"shardingNum",attrs:{placeholder:"分片数"},model:{value:e.triggerInfo.shardingNum,callback:function(t){e.$set(e.triggerInfo,"shardingNum",e._n(t))},expression:"triggerInfo.shardingNum"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"失败重试数",prop:"retryCount"}},[r("el-input",{ref:"retryCount",attrs:{placeholder:"分片数"},model:{value:e.triggerInfo.retryCount,callback:function(t){e.$set(e.triggerInfo,"retryCount",e._n(t))},expression:"triggerInfo.retryCount"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"调度策略",prop:"strategy"}},[r("el-select",{attrs:{placeholder:"调度策略"},model:{value:e.triggerInfo.strategy,callback:function(t){e.$set(e.triggerInfo,"strategy",t)},expression:"triggerInfo.strategy"}},e._l(e.strategyList,(function(e){return r("el-option",{attrs:{label:e.value,value:e.key}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"描述",prop:"description"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.triggerInfo.description,callback:function(t){e.$set(e.triggerInfo,"description",t)},expression:"triggerInfo.description"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"执行参数"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.triggerInfo.executeParam,callback:function(t){e.$set(e.triggerInfo,"executeParam",t)},expression:"triggerInfo.executeParam"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"所属组",prop:"groupId"}},[r("el-select",{attrs:{placeholder:"所属组"},on:{change:e.groupSelectChange},model:{value:e.triggerInfo.groupId,callback:function(t){e.$set(e.triggerInfo,"groupId",t)},expression:"triggerInfo.groupId"}},e._l(e.groupList,(function(e){return r("el-option",{attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"执行器"}},[r("el-select",{attrs:{placeholder:"请选择执行器"},model:{value:e.triggerInfo.executorId,callback:function(t){e.$set(e.triggerInfo,"executorId",t)},expression:"triggerInfo.executorId"}},e._l(e.executorList,(function(e){return r("el-option",{attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.saveTrigger}},[e._v("保存")])],1)],1)],1)],1)},o=[],a=r("a888"),i=r("4303"),l=r("740b"),s=r("23ba"),u=r("ed08"),c=r("0620"),g=r("2a40"),d={name:"Trigger",directives:{elDragDialog:a["a"]},data:function(){return{triggerRules:{name:[{required:!0,message:"输入触发器名字",trigger:"blur"}],description:[{required:!0,message:"输入触发器描述信息",trigger:"blur"}],cron:[{required:!0,message:"输入cron表达式",trigger:"blur"}],shardingNum:[{required:!0,message:"输入分片数",trigger:"blur"},{type:"number",message:"分片数必须为数字值"}],retryCount:[{required:!0,message:"输入重试次数",trigger:"blur"},{type:"number",message:"重试次数必须为数字值"}],strategy:[{required:!0,message:"请选择策略",trigger:"blur"}],executor:[{required:!1,message:"请选择执行器",trigger:"blur"}]},groupList:[],triggerList:[],selectInfo:{currentPage:1,pageSize:10,total:0,status:null},dialogTableVisible:!1,triggerInfo:{name:null,cron:null,strategy:0,shardingNum:0,executeParam:null,retryCount:0,description:null,executorName:null,executorId:null,groupId:null},listLoading:!1,executorList:[],executorMap:null,groupMap:null,strategyList:c["default"].strategyList,strategyMap:c["default"].strategyMap,statusMap:c["default"].statusMap,statusList:c["default"].statusList}},mounted:function(){this.getTriggerList()},methods:{groupSelectChange:function(e){var t=this;Object(l["d"])({groupId:e}).then((function(e){t.executorList=e,t.executorMap=g["a"].listToMap(t.executorList,"id","name"),0!=e.length?t.triggerInfo.executorId=e[0].id:t.triggerInfo.executorId=null}))},pageChange:function(e){this.selectInfo.currentPage=e,this.getTriggerList()},parseTime:u["d"],getTriggerList:function(){var e=this;Object(i["e"])(this.selectInfo).then((function(t){e.selectInfo.currentPage=t.pageInfo.currentPage,e.selectInfo.pageSize=t.pageInfo.pageSize,e.selectInfo.total=t.pageInfo.total,e.triggerList=t.triggerList}))},handleDrag:function(){this.$refs.select.blur()},addTriggerInfo:function(e){var t=this;this.triggerInfo={},e&&(this.triggerInfo=e),Object(s["c"])().then((function(r){t.groupList=r,t.groupMap=g["a"].listToMap(t.groupList,"id","name"),!e&&t.groupList&&0!=t.groupList.length&&(t.triggerInfo.groupId=t.groupList[0].id),t.triggerInfo.groupId&&t.groupSelectChange(t.triggerInfo.groupId),t.dialogTableVisible=!0}))},saveTrigger:function(){var e=this;this.$refs.triggerForm.validate((function(t){if(null!=e.triggerInfo.executorId){if(null!=e.triggerInfo.groupId)return t?(e.triggerInfo.executorName=e.executorMap.get(e.triggerInfo.executorId),e.triggerInfo.groupName=e.groupMap.get(e.triggerInfo.groupId),void Object(i["a"])(e.triggerInfo).then((function(){e.$alert("保存成功"),e.getTriggerList(),e.dialogTableVisible=!1}))):(e.$alert("表单填写错误"),!1);e.$alert("请选择组")}else e.$alert("请选择执行器")}))},execute:function(e){var t=this;Object(i["c"])({groupId:e.groupId,triggerId:e.id}).then((function(){t.$alert("执行成功")}))},start:function(e){var t=this;Object(i["f"])({triggerId:e.id}).then((function(){t.$alert("开启成功"),t.getTriggerList()}))},stop:function(e){var t=this;Object(i["h"])({triggerId:e.id}).then((function(){t.$alert("停止成功"),t.getTriggerList()}))},deleteTrigger:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["b"])({triggerId:e.id}).then((function(){t.$alert("删除成功"),t.getTriggerList()}))}))}}},f=d,p=r("4e82"),m=Object(p["a"])(f,n,o,!1,null,"0b9f8e53",null);t["default"]=m.exports}}]);